{"mappings":"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","sources":["public/js/index.js","public/js/login.js","public/js/logout.js","public/js/updateSetting.js","public/js/stripe.js"],"sourcesContent":["/* eslint-disable */\r\nimport { hidePopUp, showPopUp, login } from './login';\r\nimport logout from './logout';\r\nimport updateSetting from './updateSetting';\r\nimport checkoutPayment from './stripe';\r\n\r\nimport 'core-js/stable';\r\nimport 'regenerator-runtime/runtime';\r\n\r\n// DOM\r\nconst loginForm = document.querySelector('.form-login');\r\nconst logoutForm = document.querySelector('.nav__el--logout');\r\nconst updateUserForm = document.querySelector('.form-user-data');\r\nconst updatePasswordForm = document.querySelector('.form-user-settings');\r\nconst payBtn = document.getElementById('btn-payment');\r\n\r\n// LISTENER\r\nloginForm?.addEventListener('submit', function (e) {\r\n  e.preventDefault();\r\n\r\n  const { email, password } = Object.fromEntries(new FormData(this).entries());\r\n\r\n  login(email, password);\r\n});\r\n\r\nlogoutForm?.addEventListener('click', logout);\r\n\r\nupdateUserForm?.addEventListener('submit', function (e) {\r\n  e.preventDefault();\r\n\r\n  const userUpdated = new FormData(this);\r\n\r\n  console.log(userUpdated);\r\n\r\n  updateSetting(userUpdated, 'user');\r\n});\r\n\r\nupdatePasswordForm?.addEventListener('submit', async function (e) {\r\n  e.preventDefault();\r\n\r\n  document.querySelector('.btn--save-password').textContent = 'Updating....';\r\n\r\n  const newPass = Object.fromEntries(new FormData(this).entries());\r\n\r\n  await updateSetting(newPass, 'password');\r\n\r\n  document.querySelector('.btn--save-password').textContent = 'Save password';\r\n\r\n  document.querySelector('.form__input--password').value = '';\r\n  document.querySelector('.form__input--newPassword').value = '';\r\n  document.querySelector('.form__input--newPasswordConfirm').value = '';\r\n});\r\n\r\npayBtn?.addEventListener('click', async function () {\r\n  this.textContent = 'Processing...';\r\n\r\n  await checkoutPayment(this.dataset.tourId);\r\n\r\n  this.textContent = 'Book tour now!';\r\n});\r\n","/* eslint-disable */\r\n\r\n// HIDE POP UP\r\nexport const hidePopUp = function () {\r\n  const el = document.querySelector('.alert');\r\n  if (el) el.remove();\r\n};\r\n\r\n// SHOW POP UP\r\nexport const showPopUp = function (type, message) {\r\n  hidePopUp();\r\n\r\n  const markup = `<div class=\"alert alert--${type}\">${message}</div>`;\r\n  document.body.insertAdjacentHTML('afterbegin', markup);\r\n\r\n  setTimeout(hidePopUp, 1300);\r\n};\r\n\r\n// SEND LOGIN DATA TO SERVER\r\nexport const login = async (email, password) => {\r\n  try {\r\n    const res = await axios({\r\n      method: 'POST',\r\n      url: '/api/v1/users/login',\r\n      data: {\r\n        email,\r\n        password,\r\n      },\r\n    });\r\n\r\n    if (res.data.status === 'success') {\r\n      showPopUp(res.data.status, 'You are login');\r\n\r\n      setTimeout(() => {\r\n        window.location.assign('/');\r\n      }, 1500);\r\n    }\r\n\r\n  } catch (err) {\r\n    console.error(err);\r\n    showPopUp('error', err.response.data.message);\r\n  }\r\n};\r\n// prettier-ignore\r\n// document.querySelector('.form-login')?.addEventListener('submit', (e) => {\r\n//   e.preventDefault();\r\n\r\n//   const email = document.getElementById('email').value;\r\n//   const password = document.getElementById('password').value;\r\n\r\n//   login(email, password);\r\n// });\r\n\r\n// LOG OUT\r\n// document\r\n//   .querySelector('.nav__el--logout')\r\n//   ?.addEventListener('click', async function () {\r\n//     try {\r\n//       const res = await axios({\r\n//         url: 'http://localhost:3000/api/v1/users/logout',\r\n//         method: 'GET',\r\n//       });\r\n\r\n//       window.location.reload();\r\n//     } catch (err) {\r\n//       showPopUp('error', err.message);\r\n//       console.error(err);\r\n//     }\r\n//   });\r\n","/* eslint-disable */\r\n\r\nexport default async function () {\r\n  try {\r\n    const res = await axios({\r\n      url: '/api/v1/users/logout',\r\n      method: 'GET',\r\n    });\r\n\r\n    window.location.reload();\r\n  } catch (err) {\r\n    showPopUp('error', err.message);\r\n    console.error(err);\r\n  }\r\n}\r\n","/* eslint-disable */\r\nimport { hidePopUp, showPopUp } from './login.js';\r\n\r\nexport default async function (data, type) {\r\n  try {\r\n    const endpoint = type === 'password' ? 'updateMyPassword' : 'updateMe';\r\n\r\n    const res = await axios({\r\n      url: `/api/v1/users/${endpoint}`,\r\n      method: 'PATCH',\r\n      data,\r\n    });\r\n\r\n    type === 'password'\r\n      ? showPopUp('success', 'Password updated')\r\n      : showPopUp('success', 'Data updated');\r\n  } catch (err) {\r\n    console.error(err);\r\n    showPopUp('error', err.response.data.message);\r\n  }\r\n}\r\n","import { showPopUp } from './login';\r\n\r\nconst stripe = Stripe(\r\n  'pk_test_51LWN6VFI2ilgj0fiMOeStkzpJMGxdWbJKMBF9OZEC7JgCAbtP0yZ6dTWZO2tvyoEbz0hTAsUxOw8xtaGMuIoDUVL00eEhNfbED'\r\n);\r\n\r\nexport default async (tourId) => {\r\n  try {\r\n    const res = await axios(`/api/v1/booking/create-season/${tourId}`);\r\n\r\n    const { sessions } = res.data;\r\n\r\n    // await stripe.redirectToCheckout({ sessionId: sessions.id });\r\n    window.location.assign(`${sessions.url}`);\r\n  } catch (err) {\r\n    showPopUp('error', 'Payment failed');\r\n    console.error(err);\r\n  }\r\n};\r\n"],"names":[],"version":3,"file":"app.js.map","sourceRoot":"/"}